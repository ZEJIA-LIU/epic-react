{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Component","observer","useStores","ImageStore","UserStore","store","useLocalStore","width","setWidth","height","setHeight","console","log","serverFile","attributes","url","heightStr","widthStr","widthRef","useRef","heightRef","props","beforeUpload","file","currentUser","message","warning","test","type","size","error","setFile","setFilename","name","upload","then","catch","showUploadList","className","tip","spinning","isUploading","InboxOutlined","href","target","filename","src","placeholder","ref","onChange","current","value","fullStr","children"],"mappings":"6PAMQA,EAAYC,IAAZD,QAoGOE,EAnGGC,aAAS,WAAO,IAAD,EACKC,cAA1BC,EADqB,EACrBA,WAAYC,EADS,EACTA,UACdC,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACP,eACI,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE/CC,SAL+B,SAKtBD,GACLF,EAAME,MAAQA,GAGlBE,OAAQ,KACR,gBACI,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAEjDC,UAb+B,SAarBD,GAENJ,EAAMI,OAASA,EACfE,QAAQC,IAAIP,EAAMI,SAEtB,cACI,OAAON,EAAWU,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBV,EAAMW,UAAYX,EAAMY,cAIzGC,EAAWC,mBACXC,EAAYD,mBACZE,EAAQ,CACVC,aAAc,SAACC,GAEX,OADAZ,QAAQC,IAAIW,GACkB,OAA1BnB,EAAUoB,aACVC,IAAQC,QAAQ,+CACT,GAEL,wCAAwCC,KAAKJ,EAAKK,MAIpDL,EAAKM,KAAO,SACZJ,IAAQK,MAAM,qCACP,IAEX3B,EAAW4B,QAAQR,GACnBpB,EAAW6B,YAAYT,EAAKU,MAC5B9B,EAAW+B,SAASC,MAAK,WACrBxB,QAAQC,IAAIT,EAAWU,YACvBF,QAAQC,IAAI,+BACbwB,OAAM,SAACN,GACNnB,QAAQC,IAAIkB,GACZnB,QAAQC,IAAI,gCAET,IAhBHa,IAAQK,MAAM,+EACP,IAiBfO,gBAAgB,GAUpB,OACI,yBAAKC,UAAU,YACX,kBAAC,IAAD,CAAMC,IAAI,aAAaC,SAAUrC,EAAWsC,aACxC,kBAAC3C,EAAYuB,EACT,uBAAGiB,UAAU,wBACT,kBAACI,EAAA,EAAD,OAEJ,uBAAGJ,UAAU,mBAAb,0DACA,uBAAGA,UAAU,mBAAb,gHAKPlC,EAAUoB,YAAc,oCACpBrB,EAAWU,WAAa,yBAAKyB,UAAU,WACpC,wDACA,4BACI,wDACA,4BAAI,uBAAGK,KAAMxC,EAAWU,WAAWC,WAAWC,IAAID,WAAWC,IAAK6B,OAAO,UAAUzC,EAAWU,WAAWC,WAAWC,IAAID,WAAWC,MACnI,kDACA,4BAAKZ,EAAW0C,UAChB,wDACA,4BAAI,yBAAKC,IAAK3C,EAAWU,WAAWC,WAAWC,IAAID,WAAWC,IAAKuB,UAAU,cAC7E,wDACA,4BAAI,2BAAOS,YAAY,mDAAWC,IAAK9B,EAAU+B,SAhCjD,WAChB5C,EAAMG,SAASU,EAASgC,QAAQC,WAgChB,4BAAI,2BAAOJ,YAAY,mDAAWC,IAAK5B,EAAW6B,SA7BjD,WACjB5C,EAAMK,UAAUU,EAAU8B,QAAQC,WA6BlB,4BAAI,uBAAGR,KAAMtC,EAAM+C,QAASR,OAAO,UAAUvC,EAAM+C,YAGlD,MACP,SCrFHpD,G,OAXGC,aAAS,YAAmB,IAAhBoD,EAAe,EAAfA,SAClBjD,EAAcF,cAAdE,UACR,OACI,oCACKA,EAAUoB,YAAc,KACrB,yBAAKc,UAAU,QAAQe,QCHjCrD,EAAYC,aAAS,WACvB,OACI,yBAAKqC,UAAU,QACX,kBAAC,EAAD,mDACA,kBAAC,EAAD,UAMGtC","file":"static/js/8.affcd034.chunk.js","sourcesContent":["import '../style/Uploader.css'\nimport React, { useRef } from 'react'\nimport useStores from \"../stores/index.js\"\nimport { observer, useLocalStore } from 'mobx-react'\nimport { Upload, message, Spin } from 'antd';\nimport { InboxOutlined } from '@ant-design/icons';\nconst { Dragger } = Upload;\nconst Component = observer(() => {\n    const { ImageStore, UserStore } = useStores()\n    const store = useLocalStore(() => ({\n        width: null,\n        get widthStr() {\n            return store.width ? `/w/${store.width}` : ''\n        },\n        setWidth(width) {\n            store.width = width\n        },\n\n        height: null,\n        get heightStr() {\n            return store.height ? `/h/${store.height}` : ''\n        },\n        setHeight(height) {\n\n            store.height = height\n            console.log(store.height)\n        },\n        get fullStr() {\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.heightStr + store.widthStr\n        }\n\n    }))\n    const widthRef = useRef()\n    const heightRef = useRef()\n    const props = {\n        beforeUpload: (file) => {\n            console.log(file)\n            if (UserStore.currentUser === null) {\n                message.warning('请先登陆再上传')\n                return false\n            }\n            if (!(/(svg$)|(png$)|(gif$)|(jpg$)|(jpeg$)/ig.test(file.type))) {\n                message.error('只能上传svg/png/jpg/jepg/gif格式的图片')\n                return false\n            }\n            if (file.size > 1024 * 1024) {\n                message.error('图片最大为1M')\n                return false\n            }\n            ImageStore.setFile(file)\n            ImageStore.setFilename(file.name)\n            ImageStore.upload().then(() => {\n                console.log(ImageStore.serverFile)\n                console.log('上传成功')\n            }).catch((error) => {\n                console.log(error)\n                console.log('上传失败')\n            })\n            return false\n        },\n        showUploadList: false\n    }\n    const widthChange = () => {\n        store.setWidth(widthRef.current.value)\n    }\n\n    const heightChange = () => {\n        store.setHeight(heightRef.current.value)\n    }\n\n    return (\n        <div className='uploader'>\n            <Spin tip=\"Loading...\" spinning={ImageStore.isUploading}>\n                <Dragger {...props}>\n                    <p className=\"ant-upload-drag-icon\">\n                        <InboxOutlined />\n                    </p>\n                    <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\n                    <p className=\"ant-upload-hint\">\n                        仅支持svg/png/jpg/jepg/gif格式的图片且图片最大为1M\n                </p>\n                </Dragger>\n            </Spin>\n            {UserStore.currentUser ? <>\n                {ImageStore.serverFile ? <div className='preShow'>\n                    <h1>上传结果</h1>\n                    <dl>\n                        <dt>线上地址</dt>\n                        <dd><a href={ImageStore.serverFile.attributes.url.attributes.url} target=\"_blank\">{ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\n                        <dt>文件名</dt>\n                        <dd>{ImageStore.filename}</dd>\n                        <dt>图片预览</dt>\n                        <dd><img src={ImageStore.serverFile.attributes.url.attributes.url} className='preImage' /></dd>\n                        <dt>更多尺寸</dt>\n                        <dd><input placeholder=\"最大宽度（可选）\" ref={widthRef} onChange={widthChange}></input></dd>\n                        <dd><input placeholder=\"最大高度（可选）\" ref={heightRef} onChange={heightChange}></input></dd>\n                        <dd><a href={store.fullStr} target='_blank'>{store.fullStr}</a></dd>\n                    </dl>\n\n                </div> : null}\n            </> : null}\n        </div>\n    )\n})\n\n\nexport default Component;","import React from 'react'\nimport '../style/Tips.css'\nimport { observer } from 'mobx-react'\nimport useStores from '../stores/index.js'\nconst Component = observer(({ children }) => {\n    const { UserStore } = useStores()\n    return (\n        <>\n            {UserStore.currentUser ? null :\n                <div className='tips'>{children}</div>\n            }\n        </>\n    )\n})\n\nexport default Component","import React from 'react';\nimport { observer } from 'mobx-react'\nimport useStores from '../stores/index.js'\nimport Uploader from '../components/Uploader.js'\nimport Tips from '../components/Tips.js'\n\nconst Component = observer(() => {\n    return (\n        <div className='home'>\n            <Tips >请先登录再上传</Tips>\n            <Uploader />\n\n        </div>\n    )\n})\n\nexport default Component;"],"sourceRoot":""}